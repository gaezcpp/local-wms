/*!
 * chartjs-chart-treemap loader
 * Loaded via CDN but registered as local asset (Odoo-safe)
 * Chart.js v4 compatible
 */

(function () {
    function loadScript(src, callback) {
        var s = document.createElement("script");
        s.src = src;
        s.async = false;
        s.onload = callback;
        document.head.appendChild(s);
    }

    if (!window.Chart) {
        console.error("Chart.js must be loaded before treemap plugin");
        return;
    }

    // prevent double load
    if (window.Chart.registry.controllers.get("treemap")) {
        console.info("Treemap plugin already loaded");
        return;
    }

    loadScript(
        "https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@3.1.0",
        function () {
            if (window.Chart.registry.controllers.get("treemap")) {
                console.info("chartjs-chart-treemap loaded successfully");
            } else {
                console.error("Failed to load chartjs-chart-treemap");
            }
        }
    );
})();
